---
id: 189
title: 四轴飞行器进展
date: 2010-12-30 01:22:24
author: 5
group: 四轴飞行器进展
post_name: 189
---

After several weeks of struggle, the motor control method for the quadcopter finally made a breakthrough. First, here's a picture, haha! In fact, this circuit is very simple: two buttons connected to Arduino, then Arduino outputs PWM signals to the ESC (Electronic Speed Controller), and the ESC then outputs current to the motor, thus forming a device that controls the motor with buttons. However, completing such a small system also experienced many setbacks. First, both servos and ESCs are controlled by PWM waves, as shown in the picture below: This is a typical remote control used in aero models. After the receiver receives the RF signal, it demodulates the signal into PWM output to the servo or ESC. So both ESCs and servos can receive PWM signals, and the signal format is unified. However, what is the exact format, frequency, and duty cycle of the PWM signal? After searching online, there was no definite data. There is one data ratio, which is the Futaba standard: PWM frequency is 50Hz, pulse width is 920usec to 2120usec, which corresponds to 0 degrees to 180 degrees of the servo. For this value, I used a 51 microcontroller to make a PWM generator. By inputting the angle (0 to 180 degrees) on the computer, it then generated a specific PWM wave output to the servo, as shown in the picture below. But the result showed that the servo travel was obviously less than 180 degrees, barely reaching about 90 degrees. It seems that 920usec-2120usec is not the exact control data for the servo, or rather, it's not the control format for servos other than Futaba. After debugging, I found that to make the servo reach a travel of 0 to 180 degrees, the pulse width of the PWM wave should be between 800usec and 2800usec. At the same time, there was an interesting phenomenon. If a pulse signal with a width between 800usec and 2800usec is given to the servo's signal line, and then kept at a low potential, the servo will remain at the angle corresponding to that pulse. This means that the PWM frequency can be lower than 50Hz. Back to Arduino, Arduino comes with its own Servo library, which can be programmed to output specific PWM waves from specific angles. This PWM signal can then be used to control the ESC, thereby controlling the motor. Here, I must introduce the characteristics of the ESC. The ESC we use is a relatively cheap HXT ESC, but it also has a mode setting function, which can set the ESC's working mode according to different occasions. The setting process is to power on the ESC when the PWM signal is at its highest. The specific setting process can be found online. Experiments showed that the PWM signal output by Arduino at an angle of 0 had no effect on the ESC; the ESC completely ignored the existence of this signal -_-b. After careful consideration, I wondered if it was because the ESC uses Futaba's PWM format, and 800usec or Arduino's lowest PWM signal was too low for the ESC to recognize. The following is the program code that can control the motor speed: