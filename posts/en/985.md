---
id: 985
title: Reading g-sensor with Arduino
date: 2011-05-06 03:48:47
author: 5
group: Reading g-sensor with Arduino
post_name: reading-g-sensor-with-arduino
---

# Arduino g-sensor
May 2nd, 2011
iphone
Android
datasheet
MMA7260Q
datasheet
promotion/download/25270%5FMOTOROLA%5FMMA7260Q.pdf
PDF,229KB
Untitled
http://139.162.84.35/wp-content/uploads/2011/05/untitled8.jpg
untitled.jpg
http://v.youku.com/v%5Fshow/id%5FXMjYzNjIyODIw.html
Untitled
http://139.162.84.35/wp-content/uploads/2011/05/untitled9.jpg
untitled.jpg
Untitled
http://139.162.84.35/wp-content/uploads/2011/05/untitled10.jpg
untitled.jpg
#include <Servo.h>
//Author:  HE Qichen
//Email:  heqichen(a)gaishi.vicp.net
//Website:  http://gaishi.vicp.net
//Date:  2011-5-2
#define FILTER_LEVEL  3
class Filter
{
  private:
    int buffer[FILTER_LEVEL];
  public:
    Filter()
    {
      int i;
      for (i=0; i<FILTER_LEVEL; ++i)
      {
        buffer[i] = 0;
      }
    }
    int filter(int value)
    {
      int i;
      int sum;
      for (i=0; i<FILTER_LEVEL-1; ++i)
      {
        buffer[i] = buffer[i+1];
      }
      buffer[FILTER_LEVEL-1] = value;
      sum = 0;
      for (i=0; i<FILTER_LEVEL; ++i)
      {
        sum += buffer[i];
      }
      return sum / FILTER_LEVEL;
    }
};
Servo testServo;
Filter xFilter, yFilter, zFilter;
void setup()
{
  Serial.begin(9600);
  testServo.attach(2);
}
void loop()
{
  int gx, gy, gz;
  gx = analogRead(A0);
  gy = analogRead(A1);
  gz = analogRead(A2);
  Serial.print("x: ");
  Serial.print(gx, DEC);
  Serial.print("  y: ");
  Serial.print(gy, DEC);
  Serial.print("  z: ");
  Serial.println(gz, DEC);
  int fgx, fgy, fgz;
  fgx = xFilter.filter(gx);
  fgy = yFilter.filter(gy);
  fgz = zFilter.filter(gz);
  Serial.print("  fx: ");
  Serial.print(fgx, DEC);
  Serial.print("  fy: ");
  Serial.print(fgy, DEC);
  Serial.print("  fz: ");
  Serial.println(fgz, DEC);
  testServo.write((fgz-100)/3);
  //delay(10);
}